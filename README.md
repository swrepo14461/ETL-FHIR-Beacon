# FHIR to Beacon Conversion Tool

## Introduction

This project provides an Extract, Transform, Load (ETL) script to convert data from SatuSehat’s FHIR R4 resources into the GA4GH Beacon V2 Model. This script is an automation tool that converts data FHIR R4 into Beacons V2 Model individual schema.

## Disclaimer

This automation tool is provided solely for the purpose of converting data from SatuSehat’s FHIR compositions into Beacon’s V2 Model format (Individual schema). The integrity, accuracy, completeness, and validity of all data submitted—including field selection, mapping logic, and configuration—remain entirely under the responsibility of BGSi as the originating data provider. The output generated by the tool strictly reflects the data uploaded, without any modification or validation of the mapped values by the tool owner or developer.
 
BGSi expressly acknowledges that any errors, omissions, inconsistencies, or losses arising from data input, mapping configuration, or file transmission are the sole responsibility of BGSi. The tool owner shall not be held liable for any direct or indirect consequences, damages, or discrepancies resulting from the data processing activities conducted through this tool. In the event that Personal Data or data containing personal identifiers is processed through this tool, BGSi is fully responsible for ensuring compliance with all applicable data protection laws and regulations, including the lawful basis for processing, data minimisation, and confidentiality. BGSi must ensure that any transfer or transmission of such data—whether domestic or cross-border—is conducted securely and only for lawful and intended purposes. If any unauthorised access, suspected breach, or data security incident occurs during or after the use of this tool, BGSi bears full responsibility to investigate, mitigate, and fulfil any legal or regulatory notification obligations. The tool owner does not assume any duty to monitor, retain, or remediate issues related to Personal Data processing initiated by BGSi. By proceeding with the use of this tool, BGSi confirms its understanding and acceptance of all responsibilities and legal consequences related to data handling, data transfer, and Personal Data protection.

## How to Use

This ETL script can be executed in Jupyter Notebook, Google Colab, or any local environment that supports Python 3 and standard Python libraries.

### Requirements

Before running the script, ensure that your environment has:

- Python 3.12 or higher
- Git installed (for cloning the repository)
- Internet access (to download dependencies)

You can use:

- Jupyter Notebook (recommended for step-by-step execution)
- Google Colab (run directly in the cloud, no installation required)
- Any local Python environment (for example, VS Code or a command-line terminal)

### Running in local or cloud-based Notebook

#### 1. Clone the repository

This command downloads the ETL-FHIR-Beacon project from GitHub into your working directory.

```bash
!git clone https://github.com/swrepo14461/ETL-FHIR-Beacon
```

### 2. Change into the project directory

Navigate into the cloned repository so subsequent commands run in the correct folder.

```bash
%cd ETL-FHIR-Beacon/
```

### 3. Install required dependencies

This installs all Python libraries listed in the `requirements.txt` file, which are needed for the ETL process (such as pandas, requests, and FHIR/Beacon data handling libraries).

```bash
!pip install -r requirements.txt
```

### 4. Prepare Input Data

Ensure all your data files are in **FHIR JSON** format and place them into the `FHIR JSON` directory.

### 5. Run the ETL process

Execute the main script to start the extraction, transformation, and validation process on your data.

```bash
!python Main.py
```

### 6. Check the Results in the Output Folder

After the script finishes, all results will be saved in the `Result` folder. You will find two files that are automatically generated:

* **Beacon File**: Contains the final data that has been successfully transformed into the Beacon format.
* **Summary Validation**: Contains a brief report summarizing the validation results of the processed data.

## FHIR to Beacon Mapper

![FHIR to Beacon Mapping](https://www.plantuml.com/plantuml/png/lLNHJzi-47xFNt7gouzAKFsqHwHD51YYqheoXdZPzd2DByN3iItRgPGX_lTTtAPD6XBGD8qNND_tdR_pTxwS-O0k5BbA_AFK5Xtca2hqVXg2ayiYq2mr-glyHV1_abXC7t55CBgwdjt2BNbJk9Jy29uIsD1WiVJarXYaqN4Nm1VBdvG6E6L2HevqIaSt320TnX6G6a4SlU1_k5HqOHXXGmnHbZ5LhkaI0zt9lCA9xJ82rgWA-bAW3ZAK7AoNsyIvDPhFuS0vIr_oZu-ASjxvzcEZBM0eF8Sh3RppdEmAOHb2_gKoZFOK-aeOq73ZJ4gYSFGlhd90nrGfSgjofeFX1Ugq5cJZuKE2-8ILSUKsBL_xiCmX5LUOIrNEAL-IkvO-SDetowZDdFpPqNCICerDVIcz9UtVx8Wm7bSqqpwu8eqAd2b2duGkcdTegiKj1ehhlbxlYdzklDTpGhu2k7y7SmuhE9hnVQobA52DcwztJkWB5r_8ja0fE2VBaNeLVpCAoulz9SRDV4-xhnxaeJZxGDg4qihqYZ0miXAwNN9Bj7l-4DiZ9Dj4xqhRbcA4p2IvweJvTdru17l8WliIYqsqKMERpQ-0t9fqPOzVkFgDzgR3G8kiHdLUdQq3lUVTES8mu4YeuuUkn4PRP5EHIosP4Fkt2QZwQLCDAj_sBBRFVt0ozCVnELhBEi2HYjdzWxJ-LLxZ6y783wskEuKShOTWuAWrsySTLgTHcjpTw1yd-q7EhDhxFJRPMyFnVdVtXEuqV4rFyiBewb7JdJGH69kWSq4IknDZ_1RVFfj07ZBZG5RrQbIWp4gchr8r4s4qgqcVAjBfTtq22wrAJfQgGX38h9v7x-4faumyZXzZHO74CM3y3ZrNDBvVYoiCL4_IYQldA1Yt7UpDJVGWHQNQm7wecKWTSN2Zg2elsQrWCe56yxG3iJkwsplVszjTwzln5tnk0xhs9cUaHP6htm00)

Before use this application, you can review and adjust the mapping configuration file `mapper.xls`. This file acts as the conversion logic, telling the script exactly how to transform your FHIR data into the Beacon format. **Ensure the paths in this file correctly match the structure of your JSON data.**

#### How to Use the Mapper

| Header                        | Function                                                                                                                                                |
| :---------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Where to Find**       | Identifies the FHIR resource (e.g.,`Observation`, `Condition`, `Procedure`) within the source data that serves as the entry point for extraction. |
| **What to Find First**  | Specifies the FHIR field or path within the selected resource to extract data from (e.g.,`code.coding[0].display`).                                   |
| **What to Find Second** | Defines the next nested field or array element to access after the first key is found, for deeper traversal within the FHIR resource.                   |
| **What to Find Third**  | Indicates a further nested field or array level to reach the exact target data within the FHIR structure.                                               |
| **Type of Find Used**   | Describes how the search is performed in the FHIR structure (e.g., by key name, array index, or nested path).                                           |
| **What to Do**          | Specifies the action after data is located (e.g., extract the value, transform it, or apply validation).                                                |
| **Where to Use**        | Specifies the Beacon model field or nested object within the GA4GH Beacon V2 `Individual` schema where the processed data will be inserted.           |
| **What to Use First**   | Defines the primary Beacon data element or value to initialize or populate the target field.                                                            |
| **What to Use Second**  | Identifies an additional Beacon attribute or nested object used to extend or combine with the first element.                                            |
| **What to Use Third**   | Provides a third Beacon object or subfield for concatenation, mapping, or fallback purposes if applicable.                                              |
| **Type of Use Used**    | Explains how multiple data elements are combined or processed (e.g., assigned directly, concatenated, or derived).                                      |
| **What Must Be Done**   | Defines validation rules for the Beacon field (e.g., required, optional, or conditional).                                                               |
| **Default Value**       | Specifies a static default value if no valid data is found in the FHIR source.                                                                          |

